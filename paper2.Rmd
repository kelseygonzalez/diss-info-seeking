---
title: "Article 2:	Information-Seeking Behaviors for Information on Covid-19 Vaccinations"
author: "Kelsey Gonzalez"
date: "`r format(Sys.time(), '%d %B, %Y')`"
editor_options:
  chunk_output_type: console
output:
  bookdown::pdf_document2:
    latex_engine: xelatex
    number_sections: true
header-includes:
   - \usepackage{siunitx}
   - \usepackage{setspace}
   - \usepackage{dcolumn}
   - \usepackage{caption}
   - \usepackage{longtable}
   - \usepackage{booktabs}
   - \doublespacing
   - \usepackage{placeins}
csl: american-sociological-association.csl
bibliography: "My Library.bib"
indent: true
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE,
                      warning = FALSE,
                      # cache = TRUE,
                      fig.width = 7,
                      fig.asp = 0.8,
                      out.width = "80%",
                      fig.align="center"
                      # dev.args = list(png = list(type = "cairo"))
                      )



if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, glue, extrafont, here, jtools, psych,
               modelsummary, showtext, thematic, kableExtra, scales)


rain <- read_rds(here('data', 'RAiN_vacc_clean.rds')) %>% 
  mutate(across(where(is.logical), as.factor),
         date = lubridate::as_date(EndDate)) 

my_palette = c('#56b4e9','#999999','#E69F00','#009E73','#CC79A7','#0072B2','#D55E00','#E69F00')
my_palette  <- c(MetBrewer::met.brewer(name = 'Cross', type = 'discrete'), '#555F61')

## Automatically use showtext to render text
font_add_google("Lora", "lora")
showtext_auto()

theme_diss <- function(base_size = 14) {
  theme_minimal(base_size = base_size) %+replace%
    theme(
      # Figure assembly
      plot.title = element_text(family="lora",
                                size = rel(1), 
                                margin = margin(0,0,5,0), 
                                hjust = 0),
      plot.title.position = "plot",
      plot.subtitle = element_text(family="lora",
                                   size = rel(0.85)),
      plot.caption = element_text(family="lora",
                                  size = rel(0.70),
                                  hjust = 1),
      # Graphical Zones
      panel.grid.minor = element_blank(),
      panel.border = element_blank(),
      # Axes
      axis.title = element_text(family="lora", 
                                size = rel(0.85)),
      axis.text = element_text(family="lora", 
                               size = rel(0.70)),
      axis.line = element_line(color = "black", 
                               arrow = arrow(length = unit(0.3, "lines"), 
                                             type = "closed")),
      # Legend
      legend.title = element_text(family="lora",
                                  size = rel(0.85)),
      legend.text = element_text(family="lora", 
                                 size = rel(0.70)),
      legend.key = element_rect(fill = "transparent", 
                                colour = NA),
      legend.key.size = unit(1.5, "lines"),
      legend.background = element_rect(fill = "transparent", 
                                       colour = NA),
      # Facetting 
      strip.background = element_rect(fill = "#17252D",
                                      color = "#17252D"),
      strip.text = element_text(family="lora",
                                size = rel(0.85), 
                                color = "white", 
                                margin = margin(5,0,5,0))
    )
}

theme_set(theme_diss()) 

conf_int_prop <- function(var){
  p <- mean(!!var, na.rm = T)
  q <- 1 - p
  n <- nrow(rain)
  min <- p - 1.96*sqrt((p*q)/n)
  max <- p + 1.96*sqrt((p*q)/n) 
  paste0(label_percent()(min), ", ", label_percent()(max))
}
print_perc <- function(var){
  label_percent()(mean(var, na.rm = T))
}


```


## Research Methodology
The data used for this research project are based on original survey data
sampled between `r format( min(rain$date), '%B %d, %Y')`  through 
`r format(max(rain$date), '%B %d, %Y')`. This survey was hosted on Qualtrics and
participants were paid and recruited using Amazon Turk (MTurk). The total valid
survey responses (_n_ = `r nrow(rain)`) were selected from a total of 1,066
respondents; some responses were disqualified due to a few factors such as
detected usage of a VPN, random answer clicking (determined by illogical
responses), poor quality typed responses (e.g., social network alters
consistently named random nouns), or taking the survey more than once. The same
is slighted gender unbalanced, slightly skewing towards a male sample. For the
respondents who provided their zip code (p = 
`r round(nrow(rain[!is.na(rain$region),]) / nrow(rain), 2)`), the 
sample is quite balanced with a slight skew towards MTurkers in the South (p = 
`r round(nrow(rain[rain$region == 'South',]) / nrow(rain), 2)`). 
The survey took an average of `r round(mean(rain$duration), 2)` minutes with a 
standard deviation of `r round(sd(rain$duration), 2)` minutes. The shortest 
valid survey took `r round(min(rain$duration), 2)` minutes and the longest took 
`r round(max(rain$duration), 2)` minutes. Participants were paid \$6.00 for their 
time after Amazon administrative fees, funded by a Grant awarded to Kelsey E.
Gonzalez and Nicolas Legewie by the Summer Institute in Computational Social
Science and the Russell Sage Foundation. The main portion of this survey
replicates the book, Someone to Talk To  by expanding on
Small’s finding that people draw on much broader sources than “important people”
for support by segregating weak-tie social support into instrumental, emotional,
and informational support [see @houseStructuresProcessesSocial1988]. The latter
part of the survey focuses on resource activation for the specific case-study of
information during the Covid-19 pandemic analyzed in this paper.


```{r table-1-desc}
#| results = "asis"

desc_table <- rain %>% 
  select(receive_i_fr_dr,
  receive_i_fr_pers,
  receive_i_fr_tv,
  receive_i_fr_onlnet,
  receive_i_fr_onlgroup,
  int_sought,
  int_sought_fr_pers,
  int_sought_fr_dr,
  int_sought_fr_onlgroup,
  int_sought_fr_onlnet,
  int_sought_fr_onlsearch,
  int_sought_affect,
  vacc_status,
  vacc_view_pos,
  race_white,
  race_black,
  race_nat,
  race_asian, 
  hispanic,
  college,
  age, receive_i) %>% 
  as.data.frame()

datasummary(formula = 
  (`Received info` = receive_i) +
    (`Received info, Doctor` = receive_i_fr_dr) +
    (`Received info, Person` = receive_i_fr_pers) +
    (`Received info, News` = receive_i_fr_tv) +
    (`Received info, Social Networking Site` = receive_i_fr_onlnet) +
    (`Received info, Online Forum` = receive_i_fr_onlgroup) +
    (`Sought Info` = int_sought) +
    (`Sought Info, Doctor` = int_sought_fr_dr) +
    (`Sought Info, Person` = int_sought_fr_pers) +
    (`Sought Info, Social Networking Site` = int_sought_fr_onlnet) +
    (`Sought Info, Online Forum` = int_sought_fr_onlgroup) +
    (`Sought Info, Online Search` = int_sought_fr_onlsearch) +
    (`Vaccination Status` = vacc_status) +
    (`Vaccination Outlook` = vacc_view_pos) +
    (`Age` = age) +
    (`Hispanic or Latino/x` = hispanic) +
    (`Race, White` = race_white) +
    (`Race, Black` = race_black) +
    (`Race, Native American` = race_nat) +
    (`Race, Asian or Pacific Islander` = race_asian) +
    (`Associate's Deg or above` = college)  ~ 
    (Mean + SD) ,
  data = desc_table,
  fmt = '%.2f',
  title = 'Descriptive Statistics for Dichotomous and Numeric Variables',
  notes =c(glue("Notes: {nrow(rain)} Surveyed, Conducted {format( min(rain$date), '%B %d')} through {format(max(rain$date), '%B %d')}, 2021.")),
  output = "kableExtra") %>% 
  kable_styling(latex_options = c("hold_position", "striped"))

```

### Measures

####  Sought Information
There are multiple dependent variables of interest for this paper. The first
variable is a dichotomous indicator of whether someone intentionally sought out
information about Covid-19 vaccinations. The survey asked, "And how about you 
yourself intentionally looking for information about a Covid-19 vaccine? Such 
information can include things such as advice, clarification, facts, and
experiences". About `r print_perc(rain$int_sought)` ($\widehat{p}$)
of respondents had intentionally sought out information about Covid-19 
vaccinations (95% Confidence Interval = \{`r conf_int_prop(rain$int_sought)`\}).

Further dependent variables segment the above question into multiple options;
"How did you look for information about the Covid-19 vaccine?". Respondents were
posed with 5 responses and 'other', of which they could select multiple. The
largest proportion, `r print_perc(rain$int_sought_fr_dr)`, asked their 
'doctor or another health professional' (95% Confidence Interval = 
\{`r conf_int_prop(rain$int_sought_fr_dr)`\}).
About `r print_perc(rain$int_sought_fr_pers)` said they asked, 'a person 
like friend, neighbor, or family member that [they] know' (95% Confidence 
Interval = \{`r conf_int_prop(rain$int_sought_fr_pers)`\}). An additional
`r print_perc(rain$int_sought_fr_onlsearch)` searched 'for [their] question 
using an online search engine such as Google or Bing' (95% Confidence Interval 
= \{`r conf_int_prop(rain$int_sought_fr_onlsearch)`\}). About a quarter of the 
sample, `r print_perc(rain$int_sought_fr_onlgroup)`, 'posted queries in an 
online discussion group, listserve, or other online forum like a Facebook Group 
or Subreddit' (95% Confidence Interval = \{`r conf_int_prop(rain$int_sought_fr_onlgroup)`\}).
And finally, `r print_perc(rain$int_sought_fr_onlnet)` of the sample 'posted queries 
on a social networking site such as Facebook timeline, Twitter status update, or 
LinkedIn' (95% Confidence Interval = \{`r conf_int_prop(rain$int_sought_fr_onlnet)`\}).
Much of the question wording and the specific categories of search were inspired
by ICPSR project 37220

```{r table-2-desc}
#| results = "asis"


datasummary(formula = ((`Gender` = gender)+  
                         (`Highest Education Level` = educ) + 
                         (`Plan to be Vaccinated if not` = vacc_status_future)  +
                         (`Found Info Sought Useful` = int_sought_useful) +
                         (`Census Region` = region)) ~ N + Percent(), 
            data = rain,
            fmt = '%.2f',
            title = 'Descriptive Statistics for Categorical Variables',
            notes =c(glue("Notes: {nrow(rain)} Surveyed, Conducted {format( min(rain$date), '%B %d')} through {format(max(rain$date), '%B %d')}, 2021.")),
            output = "kableExtra") %>%
  kable_styling(latex_options = c("hold_position", "striped"))

## TODO reorder factors in categorical table

```

#### Vaccination Outlook

```{r}
vacc_status_freq <- rain[!is.na(rain$vacc_status_future),] %>% 
  group_by(col = vacc_status_future) %>% 
  summarise(n = n()) %>%
  mutate(n = n / sum(n))
```
Another Dependent variable for this analysis is a dichotomous variable
indicating whether the respondent has received or plans to receive a vaccination against Covid-19. For this survey, the number of doses or timeline of receipt were less
relevant to the research question. This variable instead focuses on intent or
opinion about the vaccine. About `r print_perc(rain$vacc_view_pos)` have a
positive view about the vaccine. This construct is made through the combination
of  two survey items. The first item is actual vaccination status, obtained through 
the question 'Did you receive a Covid-19 vaccine?'.
`r print_perc(rain$vacc_status)` of the sample said that
they had indeed received a vaccination (95% Confidence Interval = \{`r conf_int_prop(rain$vacc_status)`\}). As the national vaccination rate is
closer to 75%, this indicates some bias in our sample that must be
acknowledged: either MTurkers are more likely to be vaccinated that the normal
population (sampling bias) or there is some conformity bias in the responses
causing survey takers to provide false answers. The second survey item that
contributes to 'Vaccination Outlook' was only given to those who had not
responded 'yes' to the to their vaccination status. These respondents were asked 'Do you
plan to receive a vaccine for the prevention of the Covid-19 virus?'. Of those
who were asked this question (n = `r nrow(rain[!is.na(rain$vacc_status_future),])`),
`r scales::label_percent()(filter(vacc_status_freq, col == 'Definitely yes') %>% pull(n))`
said they were 'definitely yes' getting the vaccine; 
`r scales::label_percent()(filter(vacc_status_freq, col == 'Probably yes') %>% pull(n))` 
said they were 'probably yes' going to receive vaccine. The rest of the sample was more unsure: 
`r scales::label_percent()(filter(vacc_status_freq, col == 'Might or might not') %>% pull(n))`
said they 'Might or might not', 
`r scales::label_percent()(filter(vacc_status_freq, col == 'Probably not') %>% pull(n))`
said 'Probably not', and finally
`r scales::label_percent()(filter(vacc_status_freq, col == 'Definitely not') %>% pull(n))`
said they would 'definitely not' receive the vaccine. The variable 'Vaccination
Outlook' indicates that either the respondent received a Covid-19 vaccine or
either probably or definitely will in the future.


#### Independent Variables
The first independent variables used in this analysis are based on the question, 
'In the past 12 months, without searching for it, did you receive information
about the Covid-19 vaccine from … (check all sources you received information
from)'. This differs from the 'How did you look for information' question above
because this is based on passive reception of information. The largest proportion
of respondents had received information from a person like friend, neighbor, or
family member that [they] know ($\widehat{p}$ = `r print_perc(rain$receive_i_fr_pers)`
). Respondents also commonly received information from a television news channel
or a newspaper, about `r print_perc(rain$receive_i_fr_tv)` of the sample.
`r print_perc(rain$receive_i_fr_dr)` of the sample had received information from
their doctor or other health professional while `r print_perc(rain$receive_i_fr_onlnet)` 
received information from a social networking site such as Facebook timeline,
Twitter status update, or LinkedIn. Finally, the lowest proportion of the sample
had received information from an online discussion group, listserve, or other
online forum like a Facebook group or subreddit 
($\widehat{p}$ = `r print_perc(rain$receive_i_fr_onlgroup)`).

We also asked various demographic questions to understand our sample. The 
average age of our sample was `r round(mean(rain$age, na.rm = T), 2)`. 
Our sample was `r scales::label_percent()(nrow(filter(rain, gender == "Female")) / nrow(rain))`
female, and `r scales::label_percent()(nrow(filter(rain, gender == "Male")) / nrow(rain))`
male. The sample is diverse racially though some ethnic groups are underrepresented compared to national averages. Race was evaluated using the
question, 'What is your race? If you are "mixed race", select all that apply.'
Because of the multi-selection question, each variable is dichotomous and
proportions are shown. `r print_perc(rain$race_white)` of the sample claimed
they were 'White', `r print_perc(rain$race_black)` claimed to be 'Black or
African American', `r print_perc(rain$race_nat)` chose 'American Indian or
Alaskan Native', `r print_perc(rain$race_asian)` selected 'Asian', and finally 
when asked, 'Are you Hispanic, Latino/a/x, or Latin American Origin?', 
`r print_perc(rain$hispanic)` selected 'Yes'. Respondents were also asked to 
select the  highest level of education that you have completed. Based on the 
breakdown between 'Less than high school', 'High school graduate', 'Some college',
'Associate's or Technical degree', 'Bachelor's degree', and 'Graduate or 
professional degree',  `r print_perc(rain$college)` of the sample were classified
to have a college-level education (Associate's degree or above). 

## Analysis

My analytic strategy proceeds in four steps. In Tables \@ref(tab:table-1-desc) 
& \@ref(tab:table-2-desc), I present descriptive statistics for all study 
variables, including variable ranges, means, and standard deviations. For this 
paper, I rely heavily on logistic regression, modeled in `r`; specifically, I 
fit a series of Binomial Generalized Linear Models. In Table \@ref(tab:table-model-1)^[All tables in this paper were created with the modelsummary package in `r`  ]
, I fit a logistic regression model predicting
whether someone sought information about Covid-19 using their sources of
information ('Received info') as well as various demographic variables such as
age, education level and race. Figure \@ref(fig:plot-model-1) then illustrates
the relationship between the coefficients and information seeking.^[Figures in 
this paper were all created using the `r` packages jtools  and ggplot2
In Table \@ref(tab:model-2-phi) I disaggregate information seeking behaviors by
investigating the difference in proportions of each of the 5 different avenues
of seeking information about Covid-19: from another person, from a doctor, on an
online forum, on a social networking site, or using an online search tool. I
investigate these differences through a phi coefficient , otherwise
known as a mean square contingency coefficient which is used to investigate the
degree of association between two binary variables. ^[To calculate the Phi
Coefficient, I utilize the Psych `r` package  ] I then investigate the
associations between my predictors and the 5 information search vehicles by
modelling a series of logistic regressions in Table \@ref(tab:table-model-2).
Finally, in Table \@ref(tab:table-model-3), I investigate whether there is a
relationship between information receiving and information seeking behaviors and
the choice to get vaccinated against Covid-19 through a logistic regression
model predicting Vaccination Outlook.  Figure \@ref(fig:plot-model-3) then
illustrates the relationship between the coefficients and vaccination outlook.

## Results
```{r clean_before_reg}
rain_mod <- rain %>% 
  mutate(across(c(receive_i,
                  receive_i_fr_dr,
                  receive_i_fr_pers,
                  receive_i_fr_tv,
                  receive_i_fr_onlnet,
                  receive_i_fr_onlgroup,
                  int_sought,
                  int_sought_fr_pers,
                  int_sought_fr_dr,
                  int_sought_fr_onlgroup,
                  int_sought_fr_onlnet,
                  int_sought_fr_onlsearch,
                  int_sought_affect,
                  vacc_status,
                  vacc_view_pos,
                  hispanic,
                  race_white,
                  race_black,
                  race_nat,
                  race_asian, 
                  college), ~ factor(.x, levels = c(0, 1))))

regression_labels = c(
  'receive_i_fr_dr1' = 'Received Info, Doctor',
  'receive_i_fr_pers1' = 'Received Info, Person',
  'receive_i_fr_tv1' = 'Received Info, News',
  'receive_i_fr_onlnet1' = 'Received Info, Social Networking Site',
  'receive_i_fr_onlgroup1' = 'Received Info, Online Forum',
  'int_sought1' = 'Sought Info',
  'int_sought_fr_dr1' = 'Sought Info, Doctor',
  'int_sought_fr_pers1' = 'Sought Info, Person',
  'int_sought_fr_onlnet1' = 'Sought Info, Social Networking Site',
  'int_sought_fr_onlgroup1' = 'Sought Info, Online Forum',
  'int_sought_fr_onlsearch1' = 'Sought Info, Online Search',
  'age' = 'Age',
  'genderMale' = 'Gender, Male',
  'genderOther' = 'Gender, Other',
  'female' = 'Gender, Female',
    'college1' = "Associate's Deg or above",
  'race_white1' = 'White',
  'race_black1' = 'Black',
  'race_nat1' = 'Native American',
  'race_asian1' = 'Asian',
  'hispanic1' = 'Hispanic or Latino/x')
```
### Information Seeking
```{r table-model-1}
#| results = "asis"


mod1 <- glm(formula = int_sought ~ 
              receive_i_fr_dr +   
              receive_i_fr_pers +   
              receive_i_fr_tv +   
              receive_i_fr_onlnet +   
              receive_i_fr_onlgroup +   
              age + 
              gender + 
              race_white +   
              race_black +    
              race_nat +      
              race_asian +  
              hispanic  + 
              college,
            data = rain_mod, family = binomial(link="logit"))
nullmod1 <- glm(formula = int_sought ~ 1,
            data = rain_mod, family = binomial(link="logit"))
psuedor2 <- as.numeric(1-(logLik(mod1)/logLik(nullmod1)))


rows <- tribble(~term, ~model1,
                "$R_{McFadden}^2$", psuedor2)
attr(rows, 'position') <- c(14, 4)



modelsummary(mod1,
            gof_omit = 'AIC', statistic = NULL,
            estimate = "{estimate}{stars} ({std.error})",
            title = 'What predicts someone intentionally searched for information',
            add_rows = rows,
            coef_map = regression_labels,
            notes = list('* p < .05. ** p < .01. *** p < .001 (two-tailed test).',
                      'Raw, Unexponentiated Coefficients'),            
            # exponentiate = TRUE,
            output = "kableExtra") %>%
  kable_styling(latex_options = c("hold_position", "striped"))

```

```{r plot-model-1}
#| fig.cap='Plot of Coefficients, Model 1'

plot_summs(mod1, 
           scale = TRUE,
           coefs =  c(
             'Received Info, Doctor' = 'receive_i_fr_dr',
             'Received Info, Person' = 'receive_i_fr_pers',
             'Received Info, News' = 'receive_i_fr_tv',
             'Received Info, Social Networking Site' = 'receive_i_fr_onlnet',
             'Received Info, Online Forum' = 'receive_i_fr_onlgroup',
             'Sought Info' = 'int_sought',
             'Sought Info, Doctor' = 'int_sought_fr_dr',
             'Sought Info, Person' = 'int_sought_fr_pers',
             'Sought Info, Social Networking Site' = 'int_sought_fr_onlnet',
             'Sought Info, Online Forum' = 'int_sought_fr_onlgroup',
             'Sought Info, Online Search' = 'int_sought_fr_onlsearch',
             'Age' = 'age',
             'Gender, Male' = 'genderMale',
             # 'Gender, Other' = 'genderOther',
             "Associate's Deg or above" = 'college',
             'White' = 'race_white',
             'Black' = 'race_black',
             'Native American' = 'race_nat',
             'Asian' = 'race_asian',
             'Hispanic or Latino/x' = 'hispanic'),
          robust = TRUE,
           exp = TRUE) +
  labs(caption = "Coefficient for 'Gender, Other' not displayed") + 
  ylab("") + xlab("Exponentiated Coefficients, scaled & robust") + 
  theme_diss() +
  scale_color_manual(values = my_palette[6])
```
  
Table \@ref(tab:table-model-1) provides the results of my logistic regression
analysis predicting whether someone sought information about Covid-19. These
initial results suggest similar results for each vehicle of information
delivery: each mode of receiving information whether from a doctor, a person,
the news, a social networking site, or an online forum, all increase the odds of
seeking out information. For example, respondents who had received information 
from a doctor or other medical professional were `r round(exp(mod1$coefficients[['receive_i_fr_dr1']]),2)`
(relative odds ratio = $exp(\beta k)$, _p_ < 0.001) times more likely to seek
out information over someone who hadn't. Similarly, respondents who had received 
information from 'a person  like friend, neighbor, or family member that [they] know'
were `r round(exp(mod1$coefficients[['receive_i_fr_pers1']]),2)`
( _p_ < 0.001) times more likely to seek out information over someone who hadn't
received information from a person like that. Interesting, those who had
received information from an online discussion group, listserve, or other online
forum including a Facebook group or subreddit were 
`r round(exp(mod1$coefficients[['receive_i_fr_onlgroup1']]), 2)` ( _p_ < 0.001)
times more likely to search out more information than someone who hadn't. While 
most demographic variables don't seem to have a strong effect on whether someone
sought out information about the Covid-19 vaccine, a few key variables had strong
associations. Age, for instance, is associated with seeking information; every 
additional year of age a person holds they are
`r scales::label_percent()(exp(mod1$coefficients[['age']])-1)` 
more likely to search for information, possibly indicating a generational effect
of information seeking patterns ( _p_ < 0.01). Additionally, those who were more 
educated, that is those with an associate's degree or higher, were 
`r round(exp(mod1$coefficients[['college1']]), 2)` 
more likely to seek additional information than those without the degree 
( _p_ < 0.05). And finally, there is evidence to suggest that the Black or 
African American sample was more likely to seek out information, specifically: 
Blacks were `r round(exp(mod1$coefficients[['race_black1']]), 2)` times more likely 
to seek out information over non-Blacks ( _p_ < 0.05). Figure \@ref(fig:plot-model-1) illustrates
the relationship between the coefficients and information seeking.



### Information Search Vehicles

```{r model-2-phi}
phi <- rain %>% 
  select(pers = int_sought_fr_pers,
         dr = int_sought_fr_dr,
         forum = int_sought_fr_onlgroup,
         net = int_sought_fr_onlnet,
         search = int_sought_fr_onlsearch)
  
find_phi <- function(x, y){
  tab <- table(x, y)
  phi(tab, digits = 3)
}


phi_squared_tests <- 
  tribble(~col, ~Person, ~Dr, ~`Online Forum`, ~`Social Networking Site`, ~`Online Search`,
          'Person',   NA_complex_, find_phi(phi$pers, phi$dr), find_phi(phi$pers, phi$forum), find_phi(phi$pers, phi$net), find_phi(phi$pers, phi$search),
          'Dr',     NA, NA, find_phi(phi$dr, phi$forum), find_phi(phi$dr, phi$net), find_phi(phi$dr, phi$search),
          'Online Forum',  NA, NA, NA, find_phi(phi$forum, phi$net), find_phi(phi$forum, phi$search),
          'Social Networking Site',    NA, NA,NA, NA, find_phi(phi$net, phi$search),
          'Online Search', NA, NA, NA, NA, NA)

kable(phi_squared_tests, digits=3,  
      caption = "Phi Coefficient ($\\phi$) of binary association between each Information Search Vehicle",
      col.names = c("",'Person', 'Dr', 'Online Forum', 'Social Networking Site', 'Online Search')) %>% 
  kable_styling(latex_options = c("hold_position", "striped")) 

```

To further investigate how people search for information, I asked those who had
sought information out intentionally, "How did you look for information about
the Covid-19 vaccine?" Because respondents could select as many responses as
applicable, each response is recorded as a dichotomous variable. Table 
\@ref(tab:table-1-desc) reveals differences in the prevalence of usage of the 
various information seeking vehicles: Around 40% of the sample has inquired for 
information from a doctor, a person, or using online search tool (
`r percent_format()(mean(rain$int_sought_fr_dr, na.rm = T))`, 
`r percent_format()(mean(rain$int_sought_fr_pers, na.rm = T))`,
`r percent_format()(mean(rain$int_sought_fr_onlsearch, na.rm = T))`) while my 
respondents used vehicles like online forums (
`r percent_format()(mean(rain$int_sought_fr_onlgroup, na.rm = T))`) and social
networking sites (`r percent_format()(mean(rain$int_sought_fr_onlnet, na.rm = T))`)
to seek out information at significantly lower rates. To investigate how each
Information Search Vehicle are related to each other using the Phi Coefficient
($\\phi$) of binary association between each Information Search Vehicle pair.
The Phi coefficient can be interpreted like a correlation coefficient, with
numbers closer to -1 or positive one indicating a very strong relationship
. Table \@ref(tab:model-2-phi) shows...

```{r table-model-2}
#| results = "asis"

part2_models <- list()

part2_models[['Doctor']] <- glm(formula = int_sought_fr_dr ~ 
           receive_i_fr_dr + receive_i_fr_pers + receive_i_fr_tv +    
           receive_i_fr_onlnet + receive_i_fr_onlgroup + 
           age + gender + college +
           race_white + race_black + race_nat + race_asian + hispanic,  
         data = rain_mod, family = binomial(link="logit"))

part2_models[['Person']] <- glm(formula = int_sought_fr_pers ~ 
           receive_i_fr_dr + receive_i_fr_pers + receive_i_fr_tv +    
           receive_i_fr_onlnet + receive_i_fr_onlgroup + 
           age + gender + college +
           race_white + race_black + race_nat + race_asian + hispanic,  
         data = rain_mod, family = binomial(link="logit"))

part2_models[['Online Forum']] <- glm(formula = int_sought_fr_onlgroup ~ 
           receive_i_fr_dr + receive_i_fr_pers + receive_i_fr_tv +    
           receive_i_fr_onlnet + receive_i_fr_onlgroup + 
           age + gender + college +
           race_white + race_black + race_nat + race_asian + hispanic,  
         data = rain_mod, family = binomial(link="logit"))

part2_models[['Social Networking Site']] <- glm(formula = int_sought_fr_onlnet ~ 
           receive_i_fr_dr + receive_i_fr_pers + receive_i_fr_tv +    
           receive_i_fr_onlnet + receive_i_fr_onlgroup + 
           age + gender + college +
           race_white + race_black + race_nat + race_asian + hispanic,  
         data = rain_mod, family = binomial(link="logit"))

part2_models[['Online Search']] <- glm(formula = int_sought_fr_onlsearch ~ 
           receive_i_fr_dr + receive_i_fr_pers + receive_i_fr_tv +    
           receive_i_fr_onlnet + receive_i_fr_onlgroup + 
           age + gender + college +
           race_white + race_black + race_nat + race_asian + hispanic,  
         data = rain_mod, family = binomial(link="logit"))



moda <- glm(formula = int_sought_fr_dr ~ 1,
            data = rain_mod, family = binomial(link="logit"))
r2_a <- as.numeric(1-(logLik(part2_models[['Doctor']])/logLik(moda)))

modb <- glm(formula = int_sought_fr_pers ~ 1,
            data = rain_mod, family = binomial(link="logit"))
r2_b <- as.numeric(1-(logLik(part2_models[['Person']])/logLik(modb)))

modc <- glm(formula = int_sought_fr_onlgroup ~ 1,
            data = rain_mod, family = binomial(link="logit"))
r2_c <- as.numeric(1-(logLik(part2_models[['Online Forum']])/logLik(modc)))

modd <- glm(formula = int_sought_fr_onlnet ~ 1,
            data = rain_mod, family = binomial(link="logit"))
r2_d <- as.numeric(1-(logLik(part2_models[['Social Networking Site']])/logLik(modd)))

mode <- glm(formula = int_sought_fr_onlsearch ~ 1,
            data = rain_mod, family = binomial(link="logit"))
r2_e <- as.numeric(1-(logLik(part2_models[['Online Search']])/logLik(mode)))



rows <- tribble(~term, ~Doctor, ~Person, ~`Online Forum`, ~`Social Networking Site`, ~`Online Search`,
                "$R_{McFadden}^2$", r2_a,   r2_b, r2_c, r2_d, r2_e)
attr(rows, 'position') <- c(14, 9)


modelsummary(part2_models,
             align="llllll",
             statistic = NULL,
            estimate = "{estimate}{stars}",
            gof_omit = 'AIC',
            coef_map = regression_labels,
            notes = list('* p < .05. ** p < .01. *** p < .001 (two-tailed test).',
                      'Raw, Unexponentiated Coefficients'),            
            title = 'What predicts someone intentionally searched for information, by vehicle of information search',
            # exponentiate = TRUE,
            add_rows = rows,
            output = "kableExtra") %>%
  kable_styling(latex_options = c("scale_down", "hold_position", "striped"))  %>%
  add_header_above(c(" " = 1, "Dependent Variable" = 5))
```

Results of each logistic regression are displayed in Table \@ref(tab:table-model-2).
Modeling each response as a separate formula is useful for interpretation, but
there are important caveats: because each logistic regression is on a different
scale, one must not compare the magnitude of coefficients between models. We
can, however, use the direction and significance of the coefficients to draw
conclusions about these different forms of information search vehicles.

The first model in Table \@ref(tab:table-model-2) predicts whether a
respondent sought information intentionally about Covid-19 vaccinations by
asking their doctor or another health professional. First and foremost, I find
that those who received information about Covid-19 vaccinations were
`r round(exp(part2_models$Doctor$coefficients[['receive_i_fr_dr1']]), 2)` times
more likely to seek out more information from their doctor than those who had 
not ( _p_ < 0.001). However, receiving information from other vehicles also 
increased the odds of seeking out information from medical professions. Those who
received information from a person like a friend or a relative were 
`r round(exp(part2_models$Doctor$coefficients[['receive_i_fr_pers1']]), 2)` times
more likely to ask their doctor ( _p_ < 0.001), while those who received 
information from the news or television were
`r round(exp(part2_models$Doctor$coefficients[['receive_i_fr_tv1']]), 2)`
times more likely ( _p_ < 0.01). I also find that those who received information
from an online forum like a subreddit were 
`r scales::label_percent()(round(exp(part2_models$Doctor$coefficients[['receive_i_fr_onlgroup1']]), 2)-1)`
more likely to ask their doctors than those who hadn't ( _p_ < 0.05). Finally, 
respondents with an associate's degree or higher were 
`r scales::label_percent()(round(exp(part2_models$Doctor$coefficients[['college1']]), 2)-1)`
more likely to ask their doctor for information on the Covid-19 vaccinations
than those who held less education ( _p_ < 0.01).

The second model predicts whether a respondent sought information about
Covid-19 vaccinations by asking a person like friend, neighbor, or family member
that they know. Only three coefficients in this model were significant and help
us draw any conclusions on who is most likely to activate their personal social
network for informational support. In this study, I find that receiving
information about the vaccine from a doctor, their personal network, or a social
networking site is associated with seeking out more information. Those who 
received information from a doctor or other medical professional were 
`r round(exp(part2_models$Person$coefficients[['receive_i_fr_dr1']]), 2)`
times more likely to seek information from a person like a friend  ( _p_ < 0.001). 
Moreover, it seems that receiving information from your personal social network,
like a friend or relative, is associated with seeking information from those 
same people; in fact, I find that those who did are 
`r round(exp(part2_models$Person$coefficients[['receive_i_fr_pers1']]), 2)` more
likely to do so ( _p_ < 0.001). Finally, the respondents who received information
about the vaccine on a social networking site were 
`r scales::label_percent()(round(exp(part2_models$Person$coefficients[['receive_i_fr_onlnet1']]), 2)-1)`
 more likely to seek information from their personal network than those who hadn't 
( _p_ < 0.01). The unexpected result of this model is that very few factors predict
personal social network activation, and this model has the lowest McFadden's R^2, 
indicating possible omitted variables.

I also wanted to see what was associated with posting in an online discussion
group, listserve, or other online forum like a Facebook Group or Subreddit about
Covid-19 vaccinations. This is conceptually different that posting a query on a
social networking site like Facebook or twitter where identities are involved,
but is theoretically more [costly?][friction?] than searching on an internet
search engine. I found that having received information about the vaccine from 
your personal social network (like a friend or relative), the news, or an online
forum was associated with higher odds of querying an online forum. Specifically, 
receiving information from your personal network is associated with 
`r round(exp(part2_models$'Online Forum'$coefficients[['receive_i_fr_pers1']]), 2)`
higher odds ( _p_ < 0.001), from news or television media with `r round(exp(part2_models$'Online Forum'$coefficients[['receive_i_fr_tv1']]), 2)` higher odds ( _p_ < 0.05), and 
receiving information on an online forum associated with 
`r round(exp(part2_models$'Online Forum'$coefficients[['receive_i_fr_onlgroup1']]), 2)`
higher odds ( _p_ < 0.001). Moreover, I found that those with an associate's 
degree or above were 
`r round(exp(part2_models$'Online Forum'$coefficients[['college1']]), 2)` times
more likely to search for information on an online forum ( _p_ < 0.001). Finally,
I found a racial-ethnic with Hispanic-Latinos; I found that they were about 
`r scales::label_percent()(exp(part2_models$'Online Forum'$coefficients[['hispanic1']])-1)`
more likely to query an online forum than non-Hispanics ( _p_ < 0.05). However, 
there were also a few variables that lowered the odds of posting in an online 
discussion group. First, those who had received information from a social 
networking site were
`r scales::label_percent()(1-exp(part2_models$'Online Forum'$coefficients[['receive_i_fr_onlnet1']]))` 
less likely to query a forum than those who hadn't (relative odds ratio =
$1 - exp(\beta k)$, _p_ < 0.01). Moreover, I find more ethnoracial effects: 
Respondents who claimed Asian ancestry were 
`r scales::label_percent()(1-exp(part2_models$'Online Forum'$coefficients[['race_asian1']]))` 
less likely to query online forum ( _p_ < 0.01).

The fourth model predicts whether an individual sought information about 
Covid-19 vaccinations through posted queries on a social networking site such 
as Facebook timeline, Twitter status update, or LinkedIn. Receiving information
about Covid-19 seems to be quite related to posting on social media. Those who 
received information from their doctor's had 
`r round(exp(part2_models$'Social Networking Site'$coefficients[['receive_i_fr_dr1']]), 2)`
higher odds of posting on a social networking site ( _p_ < 0.01), while those 
who received their information from tv/news had `r round(exp(part2_models$'Social Networking Site'$coefficients[['receive_i_fr_tv1']]), 2)` higher odds ( _p_ < 0.05). 
Furthermore, those who received information on social networking sites were more 
likely to post queries on social networking sites ($\beta$ = 
`r round(exp(part2_models$'Social Networking Site'$coefficients[['receive_i_fr_onlnet1']]), 2)`,  _p_ < 0.001). 
The respondents in our sample who received information on online forums had
`r round(exp(part2_models$'Social Networking Site'$coefficients[['receive_i_fr_onlgroup1']]), 2)` 
higher odds of posting queries on their social networking platforms ( _p_ < 0.001). 
I found a relationship between education and posting on social networking sites
as well; specifically, those with an Associate's degree or above were `r round(exp(part2_models$'Social Networking Site'$coefficients[['college1']]), 2)` times more likely to post vaccination 
queries on social networking sites than those with lower education ( _p_ < 0.001).
Finally, I find that Hispanic-Latinos were 
`r scales::label_percent()(exp(part2_models$'Social Networking Site'$coefficients[['hispanic1']])-1)`
more likely to ask their connections on a social networking site about the 
Covid-19 vaccinations than non-Hispanics ( _p_ < 0.01).

Searching for information using an online search engine such as Google or Bing 
is theoretically the search vehicle with the least amount of social or cognitive 
friction. Our descriptive statistics showed that not everyone used this vehicle,
with only 41% of our sample (See Table \@ref(tab:table-1-desc)) having sought
information about the Covid-19 vaccines using online search engines. My model
reveals interesting patterns to help explain the variation. As with previous 
models, receiving information of any kind increase the odds of online search, 
though to varying magnitudes (Doctor:
`r round(exp(part2_models$'Online Search'$coefficients[['receive_i_fr_dr1']]), 2)` odds; 
Person:
`r round(exp(part2_models$'Online Search'$coefficients[['receive_i_fr_pers1']]), 2)` odds; 
News or Television: 
`r round(exp(part2_models$'Online Search'$coefficients[['receive_i_fr_tv1']]), 2)` odds; 
Social Networking Site:
`r round(exp(part2_models$'Online Search'$coefficients[['receive_i_fr_onlnet1']]), 2)` odds; 
Online Forum: 
`r round(exp(part2_models$'Online Search'$coefficients[['receive_i_fr_onlgroup1']]), 2)` odds).
I also find that older respondents were more likely to search online, with each 
addition year aged to yield
`r scales::label_percent()(exp(part2_models$'Online Search'$coefficients[['age']])-1)`
higher odds of searching online ( _p_ < 0.001). The most interesting variations
come from what decreases the odds of online search. First, those with an
Associate's degree or higher were 
`r scales::label_percent()(1-exp(part2_models$'Online Search'$coefficients[['college1']]))` 
less likely to search online for questions about Covid-19 than those with less
educational attainment ( _p_ < 0.001). In addition, I find that Hispanic-Latinos 
had `r scales::label_percent()(1-exp(part2_models$'Online Search'$coefficients[['hispanic1']]))` 
lower odds of searching online than non-Hispanics ( _p_ < 0.05). 


### Vaccination Views

```{r table-model-3}
#| results = "asis"


mod3 <- glm(formula = vacc_view_pos ~ receive_i_fr_dr +   
           receive_i_fr_pers +      
           receive_i_fr_tv +    
           receive_i_fr_onlnet +    
           receive_i_fr_onlgroup + 
           int_sought_fr_pers +  
           int_sought_fr_dr +    
           int_sought_fr_onlgroup +
           int_sought_fr_onlnet +
           int_sought_fr_onlsearch +
           age + 
           gender + 
           race_white +   
           race_black +    
           race_nat +      
           race_asian + hispanic +     
           college,  
         data = rain_mod, family = binomial(link="logit"))


nullmod3 <- glm(formula = vacc_view_pos ~ 1,
            data = rain_mod, family = binomial(link="logit"))
psuedor2_mod3 <- as.numeric(1-(logLik(mod3)/logLik(nullmod3)))


rows <- tribble(~term, ~model1,
                "$R_{McFadden}^2$", psuedor2_mod3)
attr(rows, 'position') <- c(19, 4)


modelsummary(mod3,
            gof_omit = 'AIC', statistic = NULL,
            estimate = "{estimate}{stars} ({std.error})",
            title = 'Does receiving or searching for information predict vaccination status?',
            notes = list('* p < .05. ** p < .01. *** p < .001 (two-tailed test).',
                      'Raw, Unexponentiated Coefficients'),            
            coef_map = regression_labels,
            add_rows = rows,
            # exponentiate = TRUE,
            output = "kableExtra") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```
Finally, in Table \@ref(tab:table-model-3), I investigate whether there is a
relationship between information receiving and information seeking behaviors and
the choice to get vaccinated against Covid-19 through a logistic regression
model predicting Vaccination Outlook. I find that receiving information from a
doctor or other medical profession is associated with 
`r round(exp(mod3$coefficients[['receive_i_fr_dr1']]), 2)` odds of receiving 
a Covid-19 vaccinated ( _p_ < 0.001) and that seeking information from a doctor
also increases the odds of vaccination by 
`r round(exp(mod3$coefficients[['int_sought_fr_dr1']]), 2)` ( _p_ < 0.001).
I find that my respondents who received information on a social networking site 
like Facebook or Twitter about the vaccines were 
`r scales::label_percent()(1-round(exp(mod3$coefficients[['receive_i_fr_onlnet1']]), 2))` 
**less likely** to get vaccinated than those who received no information through
that vehicle ( _p_ < 0.001). However, I did find that those who reached out to
family or friends with their concerns were 
`r scales::label_percent()(exp(mod3$coefficients[['int_sought_fr_pers1']])-1)` more likely
to become vaccinated ( _p_ < 0.05). Furthermore, my respondents who held an 
Associate's degree or above had `r round(exp(mod3$coefficients[['college1']]), 2)`
higher odds of becoming immunized ( _p_ < 0.001). And finally, I found further
ethnoracial differences in my sample. I found that Hispanic-Latinos had 
`r round(exp(mod3$coefficients[['hispanic1']]), 2)` higher odds of vaccination
than non-Hispanics ( _p_ < 0.05) and that my Asian sample had 
`r round(exp(mod3$coefficients[['race_asian1']]), 2)` higher odds as well over
non-Asians ( _p_ = 0.09). See Figure \@ref(fig:plot-model-3) for a visual 
representation of how these different coefficients are related to vaccination 
outlook. 
<!-- TODO: watch out about saying vaccinated, this variable is about opinion -->

```{r plot-model-3}
#| fig.cap='Plot of Coefficients, Model 3'

plot_summs(mod3,
           scale = TRUE,
           coefs =  c(
             'Received Info, Doctor' = 'receive_i_fr_dr',
             'Received Info, Person' = 'receive_i_fr_pers',
             'Received Info, News' = 'receive_i_fr_tv',
             'Received Info, Social Networking Site' = 'receive_i_fr_onlnet',
             'Received Info, Online Forum' = 'receive_i_fr_onlgroup',
             'Sought Info' = 'int_sought',
             'Sought Info, Doctor' = 'int_sought_fr_dr',
             'Sought Info, Person' = 'int_sought_fr_pers',
             'Sought Info, Social Networking Site' = 'int_sought_fr_onlnet',
             'Sought Info, Online Forum' = 'int_sought_fr_onlgroup',
             'Sought Info, Online Search' = 'int_sought_fr_onlsearch',
             'Age' = 'age',
             'Gender, Male' = 'genderMale',
             # 'Gender, Other' = 'genderOther',
             "Associate's Deg or above" = 'college',
             'White' = 'race_white',
             'Black' = 'race_black',
             'Native American' = 'race_nat',
             'Asian' = 'race_asian',
             'Hispanic or Latino/x' = 'hispanic'),
           robust = TRUE,
           exp = TRUE) +
  labs(caption = "Coefficient for 'Gender, Other' not displayed") + 
  ylab("") + xlab("Exponentiated Coefficients, scaled & robust") + 
  theme_diss()+
  scale_color_manual(values = my_palette[6])
```


```{r include = FALSE}
plot_df <- tribble(~vacc_view_pos, ~n, ~race)

plot_df <- rain %>% 
  count(race_asian, vacc_view_pos) %>% 
  filter(race_asian == T) %>% 
  mutate(race = 'Asian') %>% 
  select(-race_asian) %>% 
  bind_rows(plot_df)

plot_df <- rain %>% 
  count(race_white, vacc_view_pos) %>% 
  filter(race_white == T) %>% 
  mutate(race = 'White') %>% 
  select(-race_white) %>% 
  bind_rows(plot_df)


plot_df <- rain %>% 
  count(race_black, vacc_view_pos) %>% 
  filter(race_black == T) %>% 
  mutate(race = 'Black') %>% 
  select(-race_black) %>% 
  bind_rows(plot_df)

plot_df <- rain %>% 
  count(race_nat, vacc_view_pos) %>% 
  filter(race_nat == T) %>% 
  mutate(race = 'Native American') %>% 
  select(-race_nat) %>% 
  bind_rows(plot_df)

plot_df <- rain %>% 
  count(hispanic, vacc_view_pos) %>% 
  filter(hispanic == T) %>% 
  mutate(race = 'Hispanic') %>% 
  select(-hispanic) %>% 
  bind_rows(plot_df)

race_plot <- plot_df %>% 
  filter(!is.na(vacc_view_pos)) %>% 
  group_by(race) %>% 
  mutate(total = sum(n),
         perc = n/total,
         vacc_view_pos = fct_recode(factor(vacc_view_pos), Negative = '0', Positive = '1')) %>% 
  ggplot(aes(x = fct_reorder2(race, vacc_view_pos, perc), y = perc, fill = vacc_view_pos)) + 
  geom_col(position = 'dodge') +
  scale_y_continuous(labels = percent_format(), expand = c(0,0)) + 
  ylab("") + xlab("") + 
  theme_diss()+
  labs(fill = "Vaccinated\n or plans to") +
  scale_fill_manual(values = my_palette[c(2, 8)]) +
  coord_flip()

educ_plot <- rain %>% 
  count(educ, vacc_view_pos) %>% 
  filter(!is.na(vacc_view_pos),
         educ != 'Less than high school') %>% 
  group_by(educ) %>% 
  mutate(total = sum(n),
         perc = n/total,
         vacc_view_pos = fct_recode(factor(vacc_view_pos), Negative = '0', Positive = '1')) %>% 
  ggplot(aes(x = educ, y = perc, fill = vacc_view_pos)) + 
  geom_col(position = 'dodge') +
  scale_y_continuous(labels = percent_format(), expand = c(0,0)) + 
  ylab("") + xlab("") +
  theme_diss()+
  labs(fill = "Vaccinated\n or plans to") +
  scale_fill_manual(values = my_palette[c(2, 8)])  +
  coord_flip()

library(patchwork)
(race_plot + educ_plot)+ plot_layout(guides = "collect") + patchwork::plot_annotation(title = "Percent Vaccinated Against Covid-19", caption = glue("Notes: {nrow(rain)} Surveyed, Conducted {format( min(rain$date), '%B %d')} through {format(max(rain$date), '%B %d')}, 2021."))

```
